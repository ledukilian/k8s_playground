<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Kubernetes Playground â€“ Astuces</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    .fade-in { animation: fadeIn 0.4s ease-in-out; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(6px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body class="bg-gray-50 text-gray-900">

  <!-- NAVBAR STICKY -->
  <header class="sticky top-0 z-20 bg-white border-b shadow-sm">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-4">
      <div class="flex items-center gap-2">
        <span class="text-2xl">ğŸ§ª</span>
        <div>
          <div class="font-bold text-lg leading-tight">Kubernetes Playground</div>
          <div class="text-xs text-gray-500 leading-tight">
            k3d â€¢ Traefik â€¢ Helm â€¢ k9s
          </div>
        </div>
      </div>

      <nav class="flex items-center gap-2 text-sm">
        <a href="index.html" class="px-3 py-1.5 rounded-lg hover:bg-gray-100">
          DÃ©marrage
        </a>
        <a href="exercices.html" class="px-3 py-1.5 rounded-lg hover:bg-gray-100">
          Exercices
        </a>
        <a href="ressources.html" class="px-3 py-1.5 rounded-lg hover:bg-gray-100">
          Ressources
        </a>
        <a href="astuces.html" class="px-3 py-1.5 rounded-lg bg-blue-50 text-blue-700 font-semibold">
          Astuces
        </a>
      </nav>

      <div class="flex items-center gap-2 text-sm bg-gray-100 px-3 py-1.5 rounded-xl">
        <span class="text-gray-600">Score</span>
        <span id="score" class="font-bold text-blue-700">0</span>
        <span class="text-gray-400 text-xs">pts</span>
      </div>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-4 py-8 fade-in">

    <!-- INTRO -->
    <section class="mb-8">
      <h1 class="text-3xl font-bold mb-2">ğŸ’¡ Astuces dev & devops (orientÃ©es rÃ©el)</h1>
      <p class="text-gray-700">
        Ces astuces sont pensÃ©es comme si tu travaillais sur un vrai projet client :
        contraintes de temps, clusters partagÃ©s, CI/CD, bugs en prodâ€¦  
        Lâ€™idÃ©e : tâ€™aider Ã  prendre de bons rÃ©flexes pendant que tu joues avec le playground.
      </p>
    </section>

    <!-- ASTUCES KUBERNETES DE BASE -->
    <section class="mb-10">
      <h2 class="text-2xl font-semibold mb-4">ğŸŸ¢ Reflexes Kubernetes de base</h2>

      <div class="space-y-3">

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Toujours regarder les Ã©vÃ©nements Kubernetes avant de paniquer
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              Quand quelque chose ne marche pas (pod qui ne dÃ©marre pas, Ingress qui ne rÃ©pond pas),
              ton premier rÃ©flexe devrait Ãªtre :
            </p>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
kubectl get events -A --sort-by=.lastTimestamp
kubectl describe pod &lt;nom-du-pod&gt; -n &lt;namespace&gt;</pre>
            <p>
              Sur un vrai projet, Ã§a tâ€™Ã©vite de perdre 30 minutes Ã  modifier du code alors que le
              problÃ¨me est juste un <code>ImagePullBackOff</code>, un quota, ou un secret manquant.
            </p>
            <p class="text-gray-500 text-xs">
              ğŸ’­ Ã€ utiliser aussi dans le playground dÃ¨s quâ€™un exercice â€œne marche pasâ€.
            </p>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Utiliser des namespaces pour tout ce qui nâ€™est pas â€œjetableâ€
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              MÃªme en local, prends lâ€™habitude dâ€™utiliser un namespace par â€œprojetâ€ ou â€œcontexteâ€ :
            </p>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
kubectl create namespace playground
kubectl config set-context --current --namespace=playground</pre>
            <p>
              En entreprise, Ã§a tâ€™Ã©vitera de dÃ©ployer ta feature dans le namespace dâ€™un autre service
              ou, pire, dans <code>default</code> sur un cluster partagÃ©.
            </p>
            <p class="text-gray-500 text-xs">
              ğŸ’­ Plusieurs exercices utilisent dÃ©jÃ  un namespace dÃ©diÃ© : garde ce rÃ©flexe.
            </p>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Toujours regarder le Service avant dâ€™accuser lâ€™Ingress ou Traefik
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              Si tu accÃ¨des Ã  <code>http://frontend.localhost</code> et que tu as une erreur, vÃ©rifie
              dâ€™abord :
            </p>
            <ul class="list-disc list-inside">
              <li>Est-ce que le Service pointe sur les bons labels ?</li>
              <li>Est-ce que les pods ciblÃ©s sont en <code>Running</code> ?</li>
              <li>Est-ce que le port du Service correspond bien au port du container ?</li>
            </ul>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
kubectl describe service frontend -n playground
kubectl get pods -l app=frontend -n playground</pre>
            <p class="text-gray-500 text-xs">
              ğŸ’­ Dans la vraie vie, 50% des problÃ¨mes â€œIngress cassÃ©â€ sont en fait des soucis de Service / labels.
            </p>
          </div>
        </details>

      </div>
    </section>

    <!-- ASTUCES HELM & CONFIG -->
    <section class="mb-10">
      <h2 class="text-2xl font-semibold mb-4">ğŸ”µ Astuces Helm & configuration</h2>

      <div class="space-y-3">

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Ne jamais modifier directement les manifests gÃ©nÃ©rÃ©s par Helm
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              En entreprise, si tu modifies un manifest directement dans le cluster, Helm (ou ArgoCD)
              va finir par Ã©craser ta modification au prochain dÃ©ploiement.
            </p>
            <p>
              Dans le playground, force-toi Ã  :
            </p>
            <ul class="list-disc list-inside">
              <li>Changer les valeurs dans <code>values.yaml</code></li>
              <li>Relancer un <code>helm upgrade</code></li>
            </ul>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
helm upgrade frontend ./helm/charts/frontend -f helm/values/values-dev.yaml</pre>
            <p class="text-gray-500 text-xs">
              ğŸ’­ Bon rÃ©flexe GitOps : la vÃ©ritÃ© vient du Git + des charts, pas des commandes manuelles.
            </p>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Utiliser des valeurs par environnement dÃ¨s le dÃ©but (dev, recette, prod)
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              MÃªme dans un playground, sÃ©parer tes valeurs par environnement te prÃ©pare Ã  un vrai
              projet client :
            </p>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
helm/values/
  values-dev.yaml
  values-recette.yaml
  values-prod.yaml</pre>
            <p>
              Ensuite, tu dÃ©ploies avec :
            </p>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
helm upgrade frontend ./helm/charts/frontend -f helm/values/values-dev.yaml</pre>
            <p class="text-gray-500 text-xs">
              ğŸ’­ Ce pattern est ce que tu verras 1000 fois en mission / client.
            </p>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Toujours pouvoir faire un <code>helm rollback</code> rapidement
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              Quand un dÃ©ploiement casse quelque chose (page blanche, 500, pods qui crashent),
              tu veux que la commande de rollback soit un rÃ©flexe :
            </p>
            <pre class="bg-gray-900 text-gray-100 rounded-lg p-3 overflow-x-auto text-xs">
helm history frontend
helm rollback frontend &lt;num-version-prÃ©cÃ©dente&gt;</pre>
            <p>
              Dans le playground, teste-le en cassant volontairement un dÃ©ploiement lors dâ€™un exercice.
            </p>
            <p class="text-gray-500 text-xs">
              ğŸ’­ En prod, ce rÃ©flexe + de bons dashboards monitoring = moins dâ€™incidents longs.
            </p>
          </div>
        </details>

      </div>
    </section>

    <!-- ASTUCES DEV / DEVOPS "VRAIE VIE" -->
    <section class="mb-10">
      <h2 class="text-2xl font-semibold mb-4">ğŸ§° Astuces â€œvraie vieâ€ pour dev & devops</h2>

      <div class="space-y-3">

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Toujours reproduire un problÃ¨me en local avant dâ€™accuser le cluster partagÃ©
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              Sur un vrai projet, tu auras souvent : â€œÃ§a ne marche pas sur le cluster de recetteâ€.
              Ton but : reproduire la situation dans ton playground local.
            </p>
            <ul class="list-disc list-inside">
              <li>MÃªme version de lâ€™image Docker</li>
              <li>MÃªme valeurs Helm (ou trÃ¨s proches)</li>
              <li>MÃªme variables dâ€™environnement (API, secrets, flags)</li>
            </ul>
            <p>
              Plus tu sais reproduire un bug en local, plus tu es autonome pour le diagnostiquer.
            </p>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Surveiller les ressources avant dâ€™ajouter des pods â€œpour voirâ€
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              MÃªme en local, si tu rajoutes 10 replicas partout â€œpour testerâ€, tu vas juste saturer
              ton Docker / ton NAS.
            </p>
            <p>
              Dans un contexte client, Ã§a peut impacter dâ€™autres Ã©quipes si le cluster est partagÃ©.
            </p>
            <p>
              Habitude Ã  prendre :
            </p>
            <ul class="list-disc list-inside">
              <li>DÃ©finir des <code>resources.requests</code> et <code>limits</code> raisonnables</li>
              <li>Scalings progressifs (2 â†’ 4 â†’ 6) plutÃ´t que 2 â†’ 20 dâ€™un coup</li>
            </ul>
          </div>
        </details>

        <details class="bg-white rounded-xl shadow-sm p-4 group">
          <summary class="flex justify-between items-center cursor-pointer">
            <span class="font-medium">
              Documenter chaque commande â€œmagiqueâ€ que tu dÃ©couvres
            </span>
            <span class="text-xs text-gray-400 group-open:hidden">Cliquer pour voir lâ€™astuce</span>
            <span class="text-xs text-gray-400 hidden group-open:inline">Cliquer pour masquer</span>
          </summary>
          <div class="mt-3 text-sm text-gray-700 space-y-2">
            <p>
              Dans le playground, note dans un fichier <code>docs/cheatsheet.md</code> ou sur la
              page â€œRessourcesâ€ toutes les commandes que tu trouves utiles :
            </p>
            <ul class="list-disc list-inside">
              <li>Lister les images utilisÃ©es dans un namespace</li>
              <li>Voir quel Ingress pointe sur quel Service</li>
              <li>Voir rapidement les pods en erreur</li>
            </ul>
            <p>
              En mission, ce genre de â€œpetite doc persoâ€ te fera gagner un temps fou et aidera aussi tes collÃ¨gues.
            </p>
          </div>
        </details>

      </div>
    </section>

    <!-- CONCLUSION -->
    <section class="mb-6">
      <h2 class="text-xl font-semibold mb-2">ğŸ§­ Comment utiliser ces astuces avec le playground</h2>
      <p class="text-gray-700 text-sm">
        Quand tu fais les exercices de la page <strong>Exercices</strong>, essaie de revenir ici pour
        voir si une astuce peut tâ€™aider avant de cliquer sur â€œVoir solutionâ€.  
        Lâ€™objectif est de te rapprocher au maximum de ton futur rÃ©flexe en contexte client :
        analyser, observer, puis corriger.
      </p>
    </section>

  </main>

  <!-- SCORE SCRIPT (COMMUN) -->
  <script>
    const scoreElement = document.getElementById('score');

    function computeScoreFromLocalStorage() {
      let score = 0;
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && key.startsWith('exo_')) {
          const raw = localStorage.getItem(key);
          const val = parseInt(raw, 10);
          if (!isNaN(val)) {
            score += val;
          }
        }
      }
      return score;
    }

    function refreshScore() {
      const score = computeScoreFromLocalStorage();
      if (scoreElement) {
        scoreElement.textContent = score;
      }
    }

    // Initialisation
    refreshScore();
  </script>

</body>
</html>
